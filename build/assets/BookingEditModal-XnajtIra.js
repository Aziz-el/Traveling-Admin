import{e as w,f as j,r as o,j as a,g as N}from"./index-DBbASJ4e.js";function D({open:n,onClose:l,booking:e,onSuccess:d}){const i=w(),{showToast:m}=j(),[s,c]=o.useState({status:"pending",guests:1,date:"",amount:0}),f=t=>{if(!t)return"";const r=new Date(t),u=v=>String(v).padStart(2,"0"),x=r.getFullYear(),p=u(r.getMonth()+1),y=u(r.getDate()),b=u(r.getHours()),h=u(r.getMinutes());return`${x}-${p}-${y}T${b}:${h}`};o.useEffect(()=>{n&&c({status:e?.status??"pending",guests:e?.participants_count??e?.guests??1,date:e?.date?f(e.date):"",amount:e?.amount??0})},[n,e]),o.useEffect(()=>{if(!n)return;const t=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=t}},[n]);const g=async()=>{if(e)try{const t={status:s.status};s.date&&(t.date=new Date(s.date).toISOString()),typeof s.guests=="number"&&(t.participants_count=Number(s.guests)),typeof s.amount=="number"&&(t.amount=Number(s.amount)),await i.updateBooking(Number(e.id),t),d&&d("Бронирование обновлено"),l?.()}catch(t){console.debug(t),m("Не удалось обновить бронирование","error")}};return n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onMouseDown:t=>{t.target===t.currentTarget&&l?.(t)},children:a.jsxs("div",{className:"w-full max-w-xl p-6 bg-white rounded-lg dark:bg-gray-900",children:[a.jsx("h3",{className:"mb-4 text-lg font-semibold text-gray-900 dark:text-white",children:"Редактировать бронирование"}),a.jsxs("div",{className:"relative z-50",children:[a.jsx("label",{className:"block mb-1 text-gray-700 dark:text-gray-300",children:"Статус"}),a.jsx(N,{name:"status",value:s.status,onChange:t=>c(r=>({...r,status:t.target.value})),className:"w-full",options:[{value:"pending",label:"В ожидании"},{value:"confirmed",label:"Подтверждено"},{value:"cancelled",label:"Отменено"}]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:l,className:"px-4 py-2 border rounded-md text-gray-700 dark:border-gray-700 dark:text-gray-300",children:"Отмена"}),a.jsx("button",{onClick:g,className:"px-4 py-2 text-white bg-blue-600 rounded-md",children:"Сохранить"})]})]})}):null}export{D as default};
