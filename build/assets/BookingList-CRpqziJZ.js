import{j as e,u as f,r as c,a as P,o as E,I as _,S as D,T as I,C as L,b as B,c as U,D as A,d as M}from"./index-DBbASJ4e.js";function T(){return e.jsxs("div",{className:`\r
      flex flex-col gap-4 p-4\r
      border border-gray-200 bg-gray-50 dark:bg-gray-800\r
      rounded-xl animate-pulse\r
      md:flex-row\r
      overflow-hidden   \r
    `,children:[e.jsx("div",{className:`\r
        w-full h-28 bg-gray-300 rounded-lg dark:bg-gray-700\r
        md:w-24 md:h-24 md:flex-shrink-0\r
      `}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"h-5 bg-gray-300 rounded dark:bg-gray-700 w-2/3 md:w-1/3"}),e.jsx("div",{className:"w-16 h-5 bg-gray-300 rounded dark:bg-gray-700"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-20 h-5 bg-gray-300 rounded dark:bg-gray-700"}),e.jsx("div",{className:"w-20 h-5 bg-gray-300 rounded dark:bg-gray-700"}),e.jsx("div",{className:"w-28 h-5 bg-gray-300 rounded dark:bg-gray-700 hidden sm:block"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("div",{className:"w-24 h-4 bg-gray-300 rounded dark:bg-gray-700"}),e.jsx("span",{className:"hidden sm:block w-2 h-4 bg-gray-300 rounded dark:bg-gray-700"}),e.jsx("div",{className:"w-20 h-4 bg-gray-300 rounded dark:bg-gray-700"}),e.jsx("div",{className:"w-32 h-4 bg-gray-300 rounded dark:bg-gray-700 hidden md:block"})]})]})]})}function R({page:t,count:n,onChange:x}){const[i,u]=f(),g=r=>{r<1||r>n||(x(r),i.set("page",String(r)),u(i))},o=()=>{const r=[];for(let l=1;l<=n;l++)r.push(l);return r};return e.jsxs("div",{className:"flex justify-center items-center space-x-2 py-4",children:[e.jsx("button",{onClick:()=>g(t-1),disabled:t===1,className:"px-3 py-1 rounded-md border transition disabled:opacity-50 dark:border-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700",children:"Prev"}),o().map(r=>e.jsx("button",{onClick:()=>g(r),className:`px-3 py-1 rounded-md border transition ${r===t?"bg-blue-600 text-white border-blue-600 dark:bg-blue-500":"bg-white text-gray-700 border-gray-300 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600"} hover:bg-gray-200 dark:hover:bg-gray-700`,children:r},r)),e.jsx("button",{onClick:()=>g(t+1),disabled:t===n,className:"px-3 py-1 rounded-md border transition disabled:opacity-50 dark:border-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700",children:"Next"})]})}const $=({bookings:t,toursMap:n,onEdit:x,onDelete:i,loading:u})=>{const[g,o]=c.useState(null),r=P(),[l,j]=f(),m=5,h=Number(l.get("page"))||1,[y,b]=c.useState(h),N=a=>{b(a),l.set("page",String(a)),j(l)};c.useEffect(()=>{b(h)},[h]);const v=t.slice((y-1)*m,y*m);return c.useEffect(()=>{const a=()=>o(null);return document.addEventListener("click",a),()=>document.removeEventListener("click",a)},[]),u?e.jsx("div",{className:"p-6 space-y-4 max-h-[600px] overflow-hidden",children:Array.from({length:6}).map((a,p)=>e.jsx(T,{},p))}):e.jsxs("div",{className:"p-6 space-y-4 max-h-full",children:[v.map(a=>{const p=String(a.tour_id??a.tourId??""),d=n[p]??{},k=E(d.image_url??d.image,800,300)??"",w=a.date?new Date(a.date).toLocaleString("ru-RU"):"—";return e.jsxs("div",{onContextMenu:s=>{s.preventDefault(),o({x:s.clientX,y:s.clientY,booking:a})},onClick:()=>r(`/bookings/${a.id}`),role:"group",tabIndex:0,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),r(`/bookings/${a.id}`))},className:"cursor-pointer flex flex-col md:flex-row gap-4 p-4 border border-gray-200 bg-gray-50 dark:bg-gray-800 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 hover:shadow-md group dark:border-gray-700",children:[e.jsx("div",{className:"w-full h-40 md:w-24 md:h-24 overflow-hidden rounded-lg shadow-md flex-shrink-0",children:e.jsx(_,{src:k,alt:d.name??d.title??"Tour",className:"object-cover w-full h-full transition-transform duration-300 group-hover:scale-110"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between mb-2 gap-2",children:[e.jsx("h3",{className:"text-gray-900 truncate dark:text-white",children:d.name??d.title??"N/A"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-gray-900 dark:text-white",children:(()=>{const s=Number(d?.price??a.amount??0),S=Number(a.participants_count??a.guests??1),C=s*(S||1);return e.jsx("span",{className:"text-gray-900 dark:text-white",children:C.toLocaleString("en-US",{style:"currency",currency:"USD"})})})()}),e.jsx("button",{onClick:s=>{s.stopPropagation(),x?.(a)},className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",title:"Редактировать",children:e.jsx(D,{className:"w-4 h-4 dark:text-gray-400"})}),e.jsx("button",{onClick:s=>{s.stopPropagation(),i?.(a.id)},className:"p-1 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 text-red-600",title:"Удалить",children:e.jsx(I,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full bg-blue-50 dark:bg-blue-950 text-blue-600 dark:text-blue-400",children:d.company_id??"N/A"}),e.jsxs("span",{className:"px-2 py-1 rounded-full flex items-center gap-1 dark:bg-gray-700 bg-gray-200 text-gray-800 dark:text-gray-300",children:[a.status==="Подтверждено"&&e.jsx(L,{className:"w-3 h-3"}),a.status==="В ожидании"&&e.jsx(B,{className:"w-3 h-3"}),a.status==="Отменено"&&e.jsx(U,{className:"w-3 h-3"}),a.status??"В ожидании"]}),e.jsxs("span",{className:"px-2 py-1 rounded-full flex items-center gap-1 dark:bg-gray-700 bg-gray-200 text-gray-800 dark:text-gray-300",children:[e.jsx(A,{className:"w-3 h-3"}),a.payment_status??a.paymentStatus??"Ожидает оплаты"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{children:w}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[a.participants_count??a.guests??1," ","гостей"]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"truncate",children:a.email??""})]})]})]},a.id)}),t.length>m&&e.jsx(R,{page:y,count:Math.ceil(t.length/m),onChange:N})]})},G=c.memo($);export{G as default};
